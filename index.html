<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tay Aviator 100x</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>

  <!-- =================== CABE√áALHO =================== -->
  <header class="topbar">
    <button class="menu-btn"><i class="fas fa-bars"></i></button>
    <div class="logo">GoathBet</div>
    <nav>
      <a href="planos.html">Planos</a>
      <a href="#" id="btnLogin" style="display:inline;">Login</a>
      <a href="#" id="btnLogout" style="display:none;" onclick="logoutUsuario()">Sair</a>
    </nav>
  </header>

  <!-- =================== CONTE√öDO =================== -->
  <main class="conteudo">

    <!-- SE√á√ÉO HOME -->
    <section id="home" class="secao ativo">
      <img src="img/foto.png" alt="Tay Aviator" class="foto-principal">
      <h1>Tay Aviator 100x</h1>
      <p>Entradas inteligentes</p>
    </section>

    <!-- SE√á√ÉO GERENCIAMENTO -->
    <section id="gerenciamento" class="secao">
      <h2>üìä Gest√£o Inteligente</h2>
      <div class="resumos-grid">
        <div class="resumo-card saldo"><h4>üí∞ Saldo Atual</h4><p id="resumoSaldo">R$ 0,00</p></div>
        <div class="resumo-card investido"><h4>üì© Investido</h4><p id="resumoInvestido">R$ 0,00</p></div>
        <div class="resumo-card lucro"><h4>üìà Lucro</h4><p id="resumoLucro">R$ 0,00</p></div>
        <div class="resumo-card perdas"><h4>üìâ Preju√≠zo</h4><p id="resumoPerdas">R$ 0,00</p></div>
      </div>
    </section>

    <!-- SE√á√ÉO TIP MINER -->
    <section id="calls" class="secao">
      <h2>Tip Miner üî•</h2>
      <p class="descricao-tip">An√°lises autom√°ticas em tempo real</p>
      <div id="gridTipMiner" class="grid-tipminer"></div>
    </section>

    <style>
      .descricao-tip { text-align:center;color:#bbb;margin-bottom:10px; }
      .grid-tipminer {
        display:grid;
        grid-template-columns:repeat(auto-fill,minmax(90px,1fr));
        gap:8px;padding:15px;
      }
      .tip-card {
        border-radius:10px;text-align:center;font-weight:bold;
        color:#fff;padding:10px 5px;display:flex;
        flex-direction:column;justify-content:center;
        height:70px;transition:transform .2s;
      }
      .tip-card span{font-size:.8rem;color:rgba(255,255,255,.7);}
      .tip-card:hover{transform:scale(1.05);}
      .verde{background:#2ecc71;}
      .roxo{background:#8e44ad;}
      .rosa{background:#ff4da6;}
      .cinza{background:#3a3a3a;}
      .pulse{animation:pulseNew 1s ease-in-out;}
      @keyframes pulseNew{
        0%{box-shadow:0 0 0 0 rgba(255,77,166,0.7);}
        100%{box-shadow:0 0 0 15px rgba(255,77,166,0);}
      }
    </style>

    <!-- SE√á√ÉO JOGAR -->
    <section id="jogar" class="secao">
      <h2>Jogar</h2>
      <iframe src="https://www.goathbet.com/game/spribe-aviator?r=zktgmbwl"
        class="jogo-frame" title="Aviator" allowfullscreen></iframe>
    </section>

    <!-- SE√á√ÉO LIVE -->
    <section id="live" class="secao">
      <h2>Live</h2>
      <p>Transmiss√µes ao vivo e sinais em tempo real.</p>
    </section>
  </main>

  <!-- =================== RODAP√â =================== -->
  <footer class="footer-bar">
    <a href="#gerenciamento"><i class="fas fa-cogs"></i><span>Gerenciamento</span></a>
    <a href="#calls"><i class="fas fa-signal"></i><span>Tip Miner</span></a>
    <a href="#jogar" class="btn-jogar"><i class="fas fa-plane"></i><span>Jogar</span></a>
    <a href="#live"><i class="fas fa-video"></i><span>Live</span></a>
  </footer>

  <!-- =================== BOT√ÉO FLUTUANTE =================== -->
  <div id="btnEntrada" class="btn-entrada" title="Pr√≥xima Entrada">
    ‚è≥<span id="timerText" style="font-size:0.8rem;display:block;">60s</span>
  </div>

  <div id="cardEntrada" class="card-entrada" style="display:none;">
    <div class="card-box">
      <h3>‚è≥ Pr√≥xima Entrada</h3>
      <p><strong>Tempo Restante:</strong> <span id="tempoRestante">60s</span></p>
      <p><strong>Probabilidade:</strong> <span id="probEntrada">--x</span></p>
      <div class="alerta-horario">‚è∞ Entrar 30 segundos antes e 30 segundos depois</div>
      <div class="alerta-responsavel">‚ö†Ô∏è Jogue com responsabilidade!</div>
      <button onclick="fecharCard()">Fechar</button>
    </div>
  </div>

  <style>
    .btn-entrada {
      position: fixed; bottom: 90px; left: 20px;
      width: 70px; height: 70px; background: linear-gradient(135deg,#ff4da6,#8e44ad);
      color: #fff; border-radius: 50%; font-size: 1.5rem;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      cursor: pointer; box-shadow: 0 0 15px rgba(255,77,166,0.6);
      z-index: 2000; animation: pulseBtn 2s infinite;
    }
    @keyframes pulseBtn{0%,100%{box-shadow:0 0 10px #ff4da6;}50%{box-shadow:0 0 25px #ffb6e6;}}
    .card-entrada {
      position: fixed; inset: 0; background: rgba(0,0,0,0.7);
      display: flex; align-items: center; justify-content: center; z-index: 3000;
    }
    .card-box {
      background:#161032;border-radius:16px;padding:25px;text-align:center;
      width:90%;max-width:350px;border:2px solid #ff4da6;color:#fff;
      box-shadow:0 0 30px rgba(255,77,166,0.4);
      animation: fadeIn .4s ease-in;
    }
    .card-box button {
      background:#ff4d4d;color:#fff;border:none;padding:10px 25px;border-radius:8px;
      margin-top:15px;cursor:pointer;font-weight:bold;
    }
    .alerta-horario{background:#1e1b2e;padding:8px;margin-top:12px;border-radius:8px;}
    .alerta-responsavel{background:#ff4d4d;color:#fff;padding:10px;margin-top:10px;border-radius:8px;}
    @keyframes fadeIn{from{opacity:0;transform:translateY(10px);}to{opacity:1;transform:translateY(0);}}
  </style>

  <!-- =================== SCRIPT TIMER + FIREBASE =================== -->
  <script type="module">
    import { db } from "./firebase.js";
    import { collection, addDoc, query, orderBy, limit, onSnapshot, serverTimestamp } 
      from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const btnEntrada = document.getElementById("btnEntrada");
    const cardEntrada = document.getElementById("cardEntrada");
    const probEntrada = document.getElementById("probEntrada");
    const tempoRestante = document.getElementById("tempoRestante");
    const timerText = document.getElementById("timerText");
    const gridTipMiner = document.getElementById("gridTipMiner");

    btnEntrada.addEventListener("click", ()=> cardEntrada.style.display = "flex");
    window.fecharCard = ()=> cardEntrada.style.display = "none";

    let tempo = 60;
    let intervalo;

    function iniciarTimer(){
      intervalo = setInterval(async ()=>{
        tempo--;
        tempoRestante.innerText = tempo+"s";
        timerText.innerText = tempo+"s";

        if(tempo <= 0){
          clearInterval(intervalo);
          const multiplicador = parseFloat((Math.random() * 99 + 1).toFixed(2));
          probEntrada.innerText = `${multiplicador}x`;

          const agora = new Date();
          const hora = agora.getHours();
          const minuto = agora.getMinutes();

          await addDoc(collection(db,"tipminer"),{
            multiplicador,
            hora,
            minuto,
            criadoEm: serverTimestamp()
          });

          // Reinicia
          tempo = 60;
          iniciarTimer();
        }
      },1000);
    }
    iniciarTimer();

    // Mostrar TipMiner salvo
    const q = query(collection(db,"tipminer"),orderBy("criadoEm","desc"),limit(60));
    onSnapshot(q,(snap)=>{
      gridTipMiner.innerHTML="";
      snap.forEach(doc=>{
        const d=doc.data();
        const cor = d.multiplicador>=10?"rosa":d.multiplicador>=5?"roxo":d.multiplicador>=2?"verde":"cinza";
        const card=document.createElement("div");
        card.className=`tip-card ${cor} pulse`;
        card.innerHTML=`<div>${d.multiplicador.toFixed(2)}x</div><span>${String(d.hora).padStart(2,"0")}:${String(d.minuto).padStart(2,"0")}</span>`;
        gridTipMiner.appendChild(card);
      });
    });
  </script>

  <script>
    const links=document.querySelectorAll('.footer-bar a');
    const secoes=document.querySelectorAll('.secao');
    links.forEach(link=>{
      link.addEventListener('click',e=>{
        e.preventDefault();
        secoes.forEach(sec=>sec.classList.remove('ativo'));
        links.forEach(l=>l.classList.remove('ativo'));
        const alvo=link.getAttribute('href').replace('#','');
        document.getElementById(alvo).classList.add('ativo');
        link.classList.add('ativo');
      });
    });
  </script>
</body>
</html>